{% extends 'base.html' %}
{% load static %}
{% load leaflet_tags %}
{% load crispy_forms_tags %}

{% block extracss %}
  {% leaflet_css %}
  {% leaflet_css plugins="forms" %}
{% endblock %}

{% block extrajs %}
  {% leaflet_js %}
  {% leaflet_js plugins="forms" %}
{% endblock %}

{% block content %}

<div class="col col-lg-10 card">
  <div class="card-body">
    <h2 class="card-title">{{location}}</h2>
    <small class="form-text text-muted"><b>{{location.agency}}</b> location in <b>{{location.country}}</b>.</small>
    <br />

    {% leaflet_map "main" callback="main_map_init" %}
    <br />

    <table id="locations-list" class="table table-striped table-responsive table-bordered rounded card-text">
    <thead>
    </thead>
    <tbody>

      {% for label, content in rows %}
        {% if content %}
        <tr>
          <td style="width: 25%"><b>{{label}}</b></td>
          <td>{{content}}</td>
        </tr>
        {% endif %}
      {% endfor %}

    </tbody>
    </table>

  <a class="btn btn-secondary float-right" href="{% url 'locations-list' %}">Back to location list</a>
  </div>
</div>

<script type="text/javascript">
  function main_map_init (map, options) {
    var raw_data = '{{location.geometry.geojson|escapejs}}';
    var data = JSON.parse(raw_data);
    L.geoJson(data).addTo(map);
  }
</script>

{% endblock %}
